<?php
$dig=[0,0,0,0,0];

//$dig[0] |= 8;
//$dig[0] |= 4;
//$dig[0] |= 2;
//$dig[0] |= 1;
//$dig[0] |= 16;

// $v=0;
// $v |= (1 | 16);
// printf('%08b',  $v);
// exit;


// plus
$map=
    [
        'ERROR'=>[ 0    , 32|4 , 0     , 0      , 8      ],
        'minus'=>[ 0    , 0    , 0     , 64     , 0      ],
        'plus'=> [ 0    , 0    , 64    , 64     , 0      ],
        '1___'=> [ 0    , 64   , 0     , 0      , 0      ],
        'dot'=>  [ 0    , 8    , 0     , 0      , 0      ],
        '0__'=>   [64|32 , 0    ,  32   , 32     , 16|32  ],
        '9__'=>   [64|32 , 32   ,  0    , 32     , 16|32  ],
        '8__'=>   [64|32 , 32   ,  32   , 32     , 16|32  ],
        '7__'=>   [64    , 0    ,  0    , 32     , 16     ],
        '6__'=>   [64|32 , 32   ,  32   , 0      , 16|32  ],
        '5__'=>   [64|32 , 32   ,  0    , 0      , 16|32  ],
        '4__'=>   [0     , 32   ,  0    , 32     , 16|32  ],
        '3__'=>   [64|32 , 32   ,  0    , 32     , 16     ],
        '2__'=>   [64|32 , 32   ,  32   , 32     , 0      ],
        '1__'=>   [0     , 0    ,  0    , 32     , 16     ],
        '_0_'=>   [16    , 16   ,  8|16 , 8|16   , 0      ],
        '_9_'=>   [0     , 16   ,  8|16 , 8|16   , 8      ],
        '_8_'=>   [16    , 16   ,  8|16 , 8|16   , 8      ],
        '_7_'=>   [0     , 16   ,  8    ,   16   , 0      ],
        '_6_'=>   [16    , 0    ,  8|16 , 8|16   , 8      ],
        '_5_'=>   [0     , 0    ,  8|16 , 8|16   , 8      ],
        '_4_'=>   [0     , 16   ,  8|16 , 0      , 8      ],
        '_3_'=>   [0     , 16   ,  8    , 8|16   , 8      ],
        '_2_'=>   [16    , 16   ,  0    , 8|16   , 8      ],
        '_1_'=>   [0     , 16   ,  8    , 0      , 0      ],
        '__0'=>   [4|8   , 0    ,  4    , 4      , 4|2    ],
        '__9'=>   [4|8   , 4    ,  0    , 4      , 4|2    ],
        '__8'=>   [4|8   , 4    ,  4    , 4      , 4|2    ],
        '__7'=>   [  8   , 0    ,  0    , 4      , 2      ],
        '__6'=>   [4|8   , 4    ,  4    , 0      , 4|2    ],
        '__5'=>   [4|8   , 4    ,  0    , 0      , 4|2    ],
        '__4'=>   [0     , 4    ,  0    , 4      , 4|2    ],
        '__3'=>   [4|8   , 4    ,  0    , 4      , 2      ],
        '__2'=>   [4|8   , 4    ,  4    , 4      , 0      ],
        '__1'=>   [  0   , 0    ,  0    , 4      , 2      ],

    ];



foreach ($map as $key=>$vas)
{
    echo "#define VOLCODE_".strtoupper($key)."(data)\t\tVOLCODE_CODER(data,".implode(',',$vas).")\n";
}
echo "\n";

$k=['1___','5__','_4_','__3'];// 'dot','plus',

foreach ($k as $key) {
    if (!isset($map[$key])) {
        echo 'error key';

        continue;
    }

    foreach ($map[$key] as $byte=>$bits) {
        $dig[$byte] |= $bits;
    }

}


// ---- print
foreach ($dig as $pos=>$v)
{
    echo "$pos = ";
    printf('%08b',  $v);
    echo "\t\t$v\n";
}
echo "\n";
// "\t".$v
// {"cmd":"vfdSet","addr":66,"b0":0,"b1":0,"b2":0,"b3":7,"b4":7}
// {"cmd":"vfdSet","addr":41,"b0":12,"b1":15,"b2":23,"b3":0,"b4":3}
$out=[];
$out['cmd']='vfdSet';
$out['addr']=66;
$out['b0']=$dig[0];
$out['b1']=$dig[1];
$out['b2']=$dig[2];
$out['b3']=$dig[3];
$out['b4']=$dig[4];

echo json_encode($out)."\n\n";